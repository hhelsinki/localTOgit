{"ast":null,"code":"import React, { useRef, useMemo } from 'react';\nimport { useLibrary } from 'react-weblibrary';\nimport { GoogleApiContext } from './GoogleApiContext.js';\n\nfunction GoogleApiProvider(_ref) {\n  let {\n    clientId,\n    children\n  } = _ref;\n  const [gapi] = useLibrary('gapi', 'https://apis.google.com/js/api.js');\n  const requested = useRef({\n    modules: [],\n    discoveryDocs: [],\n    scopes: []\n  }).current;\n  const loading = useRef({\n    modules: [],\n    discoveryDocs: [],\n    scopes: []\n  }).current;\n  const done = useRef({\n    discoveryDocs: [],\n    scopes: []\n  }).current;\n\n  function configure(options, state) {\n    const modules = (options.modules ?? []).concat(options.discoveryDocs?.length ? ['client'] : [], options.scopes?.length ? ['auth2'] : []);\n\n    if (gapi) {\n      return doConfigure(gapi, clientId, requested, loading, done, { ...options,\n        modules\n      }, state);\n    }\n  }\n\n  const context = useMemo(() => ({\n    gapi\n  }), [gapi]);\n  context.configure = gapi ? configure : undefined;\n  return /*#__PURE__*/React.createElement(GoogleApiContext.Provider, {\n    value: context\n  }, children);\n}\n\nfunction doConfigure(gapi, clientId, requested, loading, done, options1, state1) {\n  return load(options1, state1);\n\n  function load(options, state) {\n    const {\n      modules = []\n    } = options;\n    const missingModules = modules.filter(k => !gapi[k]);\n\n    if (!missingModules.length) {\n      return init(options, state);\n    }\n\n    const loadModules = missingModules.filter(k => !loading.modules.includes(k));\n\n    if (loadModules.length) {\n      loading.modules.push(...loadModules);\n      gapi.load(missingModules.join(':'), () => {\n        loading.modules = loading.modules.filter(k => !missingModules.includes(k));\n        init(options, state);\n      });\n    }\n  }\n\n  function init(options, state) {\n    const {\n      scopes = [],\n      discoveryDocs = []\n    } = options;\n    const auth = gapi.auth2?.getAuthInstance();\n\n    const missingScopes = (() => {\n      if (!scopes.length || !auth) {\n        return scopes;\n      }\n\n      const grantedScopes = (auth.currentUser.get()?.getGrantedScopes() ?? '').split(' ');\n      return scopes.filter(k => !grantedScopes.includes(k));\n    })();\n\n    const missingDiscoveryDocs = discoveryDocs.filter(k => !done.discoveryDocs.includes(k));\n    const missingScopesNotDone = missingScopes.filter(k => !done.scopes.includes(k)); // collect missing scopes and discoveryDocs from different hook calls to reduce calls\n    // to auth2.init(), GoogleUser.grant() and client.init()\n\n    if (missingScopes.length) {\n      const requestScopes = missingScopes.filter(k => !requested.scopes.includes(k));\n      requested.scopes.push(...requestScopes); // prevent asking for the same scope multiple times\n\n      if (missingScopesNotDone.length) {\n        new Promise(() => doInitScopes(options, state));\n      }\n    }\n\n    if (missingDiscoveryDocs.length) {\n      const requestDiscoveryDocs = missingDiscoveryDocs.filter(k => !requested.discoveryDocs.includes(k));\n      requested.discoveryDocs.push(...requestDiscoveryDocs);\n      new Promise(() => doInitDiscoveryDocs(options, state));\n    }\n\n    if (!missingScopesNotDone.length && !missingDiscoveryDocs.length) {\n      state(JSON.stringify(options));\n      return gapi;\n    }\n  }\n\n  function doInitScopes(options, state) {\n    const loadScopes = requested.scopes.filter(k => !loading.scopes.includes(k));\n\n    if (loadScopes.length && gapi?.auth2) {\n      loading.scopes.push(...loadScopes);\n      const auth = gapi.auth2.getAuthInstance() ?? gapi.auth2.init({\n        client_id: clientId,\n        scope: loadScopes.join(' ')\n      });\n\n      if (!options.requestScopes) {\n        done.scopes.push(...loadScopes);\n        auth.then(() => init(options, state));\n        return;\n      }\n\n      auth.then(() => {\n        loading.scopes = loading.scopes.filter(k => !loadScopes.includes(k));\n        return auth.isSignedIn.get() ? auth.currentUser.get().grant({\n          scope: loadScopes.join(' ')\n        }) : auth.signIn({\n          scope: loadScopes.join(' ')\n        });\n      }).then(() => {\n        done.scopes.push(...loadScopes);\n        init(options, state);\n      }, _ref2 => {\n        let {\n          error\n        } = _ref2;\n        done.scopes.push(...loadScopes);\n        console.error(`Failed to request scopes: \\n${loadScopes.join('\\n')}\\n\\nFailed with:\\n${error}`);\n      });\n    } else {\n      // some other hook call already triggered the auth request - wait for it\n      setTimeout(() => init(options, state), 100);\n    }\n  }\n\n  function doInitDiscoveryDocs(options, state) {\n    const loadDiscoveryDocs = requested.discoveryDocs.filter(k => !loading.discoveryDocs.includes(k));\n\n    if (loadDiscoveryDocs.length && gapi?.client) {\n      loading.discoveryDocs.push(...loadDiscoveryDocs);\n      gapi.client.init({\n        discoveryDocs: loadDiscoveryDocs\n      }).then(() => {\n        done.discoveryDocs.push(...loadDiscoveryDocs);\n        init(options, state);\n      }, _ref3 => {\n        let {\n          error\n        } = _ref3;\n        return console.error(`Failed to load resources: \\n${loadDiscoveryDocs.join('\\n')}\\n\\nFailed with:\\n${error}`);\n      }).then(() => {\n        loading.discoveryDocs = loading.discoveryDocs.filter(k => !loadDiscoveryDocs.includes(k));\n      });\n    } else {\n      // some other hook call already triggered the client.init() - wait for it\n      setTimeout(() => init(options, state), 100);\n    }\n  }\n}\n\nexport { GoogleApiProvider };","map":{"version":3,"names":["React","useRef","useMemo","useLibrary","GoogleApiContext","GoogleApiProvider","clientId","children","gapi","requested","modules","discoveryDocs","scopes","current","loading","done","configure","options","state","concat","length","doConfigure","context","undefined","createElement","Provider","value","options1","state1","load","missingModules","filter","k","init","loadModules","includes","push","join","auth","auth2","getAuthInstance","missingScopes","grantedScopes","currentUser","get","getGrantedScopes","split","missingDiscoveryDocs","missingScopesNotDone","requestScopes","Promise","doInitScopes","requestDiscoveryDocs","doInitDiscoveryDocs","JSON","stringify","loadScopes","client_id","scope","then","isSignedIn","grant","signIn","error","console","setTimeout","loadDiscoveryDocs","client"],"sources":["/home/hhelsinki/sandbox-react/react-app/node_modules/react-gapi/dist/esm/GoogleApiProvider.js"],"sourcesContent":["import React, { useRef, useMemo } from 'react';\nimport { useLibrary } from 'react-weblibrary';\nimport { GoogleApiContext } from './GoogleApiContext.js';\n\nfunction GoogleApiProvider({ clientId , children  }) {\n    const [gapi] = useLibrary('gapi', 'https://apis.google.com/js/api.js');\n    const requested = useRef({\n        modules: [],\n        discoveryDocs: [],\n        scopes: []\n    }).current;\n    const loading = useRef({\n        modules: [],\n        discoveryDocs: [],\n        scopes: []\n    }).current;\n    const done = useRef({\n        discoveryDocs: [],\n        scopes: []\n    }).current;\n    function configure(options, state) {\n        const modules = (options.modules ?? []).concat(options.discoveryDocs?.length ? [\n            'client'\n        ] : [], options.scopes?.length ? [\n            'auth2'\n        ] : []);\n        if (gapi) {\n            return doConfigure(gapi, clientId, requested, loading, done, {\n                ...options,\n                modules\n            }, state);\n        }\n    }\n    const context = useMemo(()=>({\n            gapi\n        })\n    , [\n        gapi\n    ]);\n    context.configure = gapi ? configure : undefined;\n    return /*#__PURE__*/ React.createElement(GoogleApiContext.Provider, {\n        value: context\n    }, children);\n}\nfunction doConfigure(gapi, clientId, requested, loading, done, options1, state1) {\n    return load(options1, state1);\n    function load(options, state) {\n        const { modules =[]  } = options;\n        const missingModules = modules.filter((k)=>!gapi[k]\n        );\n        if (!missingModules.length) {\n            return init(options, state);\n        }\n        const loadModules = missingModules.filter((k)=>!loading.modules.includes(k)\n        );\n        if (loadModules.length) {\n            loading.modules.push(...loadModules);\n            gapi.load(missingModules.join(':'), ()=>{\n                loading.modules = loading.modules.filter((k)=>!missingModules.includes(k)\n                );\n                init(options, state);\n            });\n        }\n    }\n    function init(options, state) {\n        const { scopes =[] , discoveryDocs =[]  } = options;\n        const auth = gapi.auth2?.getAuthInstance();\n        const missingScopes = (()=>{\n            if (!scopes.length || !auth) {\n                return scopes;\n            }\n            const grantedScopes = (auth.currentUser.get()?.getGrantedScopes() ?? '').split(' ');\n            return scopes.filter((k)=>!grantedScopes.includes(k)\n            );\n        })();\n        const missingDiscoveryDocs = discoveryDocs.filter((k)=>!done.discoveryDocs.includes(k)\n        );\n        const missingScopesNotDone = missingScopes.filter((k)=>!done.scopes.includes(k)\n        );\n        // collect missing scopes and discoveryDocs from different hook calls to reduce calls\n        // to auth2.init(), GoogleUser.grant() and client.init()\n        if (missingScopes.length) {\n            const requestScopes = missingScopes.filter((k)=>!requested.scopes.includes(k)\n            );\n            requested.scopes.push(...requestScopes);\n            // prevent asking for the same scope multiple times\n            if (missingScopesNotDone.length) {\n                new Promise(()=>doInitScopes(options, state)\n                );\n            }\n        }\n        if (missingDiscoveryDocs.length) {\n            const requestDiscoveryDocs = missingDiscoveryDocs.filter((k)=>!requested.discoveryDocs.includes(k)\n            );\n            requested.discoveryDocs.push(...requestDiscoveryDocs);\n            new Promise(()=>doInitDiscoveryDocs(options, state)\n            );\n        }\n        if (!missingScopesNotDone.length && !missingDiscoveryDocs.length) {\n            state(JSON.stringify(options));\n            return gapi;\n        }\n    }\n    function doInitScopes(options, state) {\n        const loadScopes = requested.scopes.filter((k)=>!loading.scopes.includes(k)\n        );\n        if (loadScopes.length && gapi?.auth2) {\n            loading.scopes.push(...loadScopes);\n            const auth = gapi.auth2.getAuthInstance() ?? gapi.auth2.init({\n                client_id: clientId,\n                scope: loadScopes.join(' ')\n            });\n            if (!options.requestScopes) {\n                done.scopes.push(...loadScopes);\n                auth.then(()=>init(options, state)\n                );\n                return;\n            }\n            auth.then(()=>{\n                loading.scopes = loading.scopes.filter((k)=>!loadScopes.includes(k)\n                );\n                return auth.isSignedIn.get() ? auth.currentUser.get().grant({\n                    scope: loadScopes.join(' ')\n                }) : auth.signIn({\n                    scope: loadScopes.join(' ')\n                });\n            }).then(()=>{\n                done.scopes.push(...loadScopes);\n                init(options, state);\n            }, ({ error  })=>{\n                done.scopes.push(...loadScopes);\n                console.error(`Failed to request scopes: \\n${loadScopes.join('\\n')}\\n\\nFailed with:\\n${error}`);\n            });\n        } else {\n            // some other hook call already triggered the auth request - wait for it\n            setTimeout(()=>init(options, state)\n            , 100);\n        }\n    }\n    function doInitDiscoveryDocs(options, state) {\n        const loadDiscoveryDocs = requested.discoveryDocs.filter((k)=>!loading.discoveryDocs.includes(k)\n        );\n        if (loadDiscoveryDocs.length && gapi?.client) {\n            loading.discoveryDocs.push(...loadDiscoveryDocs);\n            gapi.client.init({\n                discoveryDocs: loadDiscoveryDocs\n            }).then(()=>{\n                done.discoveryDocs.push(...loadDiscoveryDocs);\n                init(options, state);\n            }, ({ error  })=>console.error(`Failed to load resources: \\n${loadDiscoveryDocs.join('\\n')}\\n\\nFailed with:\\n${error}`)\n            ).then(()=>{\n                loading.discoveryDocs = loading.discoveryDocs.filter((k)=>!loadDiscoveryDocs.includes(k)\n                );\n            });\n        } else {\n            // some other hook call already triggered the client.init() - wait for it\n            setTimeout(()=>init(options, state)\n            , 100);\n        }\n    }\n}\n\nexport { GoogleApiProvider };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}