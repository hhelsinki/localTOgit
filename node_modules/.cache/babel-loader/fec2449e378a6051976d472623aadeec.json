{"ast":null,"code":"import { useRef, useState, useEffect } from 'react';\n\nfunction getFromWindow(varName) {\n  return window[varName];\n}\n\nfunction useLibrary(varName, src) {\n  let props = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  const library = useRef(getFromWindow(varName));\n  const [status, setStatus] = useState(library.current ? 'load' : 'try');\n  useEffect(() => {\n    if (status !== 'try') {\n      return;\n    }\n\n    const el = document.createElement('script');\n    el.src = src;\n    Object.keys(props).forEach(k => {\n      el[k] = props[k];\n    });\n    el.addEventListener('load', () => {\n      library.current = getFromWindow(varName);\n      setStatus(library.current ? 'load' : 'error');\n    });\n    el.addEventListener('error', () => setStatus('error'));\n    el.addEventListener('abort', () => setStatus('abort'));\n    document.body.appendChild(el);\n    return () => {\n      document.body.removeChild(el);\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps -- props might change every render\n  }, [varName, src, status]);\n  const tryAgain = ['try', 'load'].includes(status) ? () => {\n    return;\n  } : () => setStatus('try');\n  return [library.current, status, tryAgain];\n}\n\nexport { useLibrary };","map":{"version":3,"names":["useRef","useState","useEffect","getFromWindow","varName","window","useLibrary","src","props","library","status","setStatus","current","el","document","createElement","Object","keys","forEach","k","addEventListener","body","appendChild","removeChild","tryAgain","includes"],"sources":["/home/hhelsinki/sandbox-react/react-app/node_modules/react-weblibrary/dist/esm/useLibrary.js"],"sourcesContent":["import { useRef, useState, useEffect } from 'react';\n\nfunction getFromWindow(varName) {\n    return window[varName];\n}\nfunction useLibrary(varName, src, props = {}) {\n    const library = useRef(getFromWindow(varName));\n    const [status, setStatus] = useState(library.current ? 'load' : 'try');\n    useEffect(()=>{\n        if (status !== 'try') {\n            return;\n        }\n        const el = document.createElement('script');\n        el.src = src;\n        Object.keys(props).forEach((k)=>{\n            el[k] = props[k];\n        });\n        el.addEventListener('load', ()=>{\n            library.current = getFromWindow(varName);\n            setStatus(library.current ? 'load' : 'error');\n        });\n        el.addEventListener('error', ()=>setStatus('error')\n        );\n        el.addEventListener('abort', ()=>setStatus('abort')\n        );\n        document.body.appendChild(el);\n        return ()=>{\n            document.body.removeChild(el);\n        };\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- props might change every render\n    }, [\n        varName,\n        src,\n        status\n    ]);\n    const tryAgain = [\n        'try',\n        'load'\n    ].includes(status) ? ()=>{\n        return;\n    } : ()=>setStatus('try')\n    ;\n    return [\n        library.current,\n        status,\n        tryAgain\n    ];\n}\n\nexport { useLibrary };\n"],"mappings":"AAAA,SAASA,MAAT,EAAiBC,QAAjB,EAA2BC,SAA3B,QAA4C,OAA5C;;AAEA,SAASC,aAAT,CAAuBC,OAAvB,EAAgC;EAC5B,OAAOC,MAAM,CAACD,OAAD,CAAb;AACH;;AACD,SAASE,UAAT,CAAoBF,OAApB,EAA6BG,GAA7B,EAA8C;EAAA,IAAZC,KAAY,uEAAJ,EAAI;EAC1C,MAAMC,OAAO,GAAGT,MAAM,CAACG,aAAa,CAACC,OAAD,CAAd,CAAtB;EACA,MAAM,CAACM,MAAD,EAASC,SAAT,IAAsBV,QAAQ,CAACQ,OAAO,CAACG,OAAR,GAAkB,MAAlB,GAA2B,KAA5B,CAApC;EACAV,SAAS,CAAC,MAAI;IACV,IAAIQ,MAAM,KAAK,KAAf,EAAsB;MAClB;IACH;;IACD,MAAMG,EAAE,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAX;IACAF,EAAE,CAACN,GAAH,GAASA,GAAT;IACAS,MAAM,CAACC,IAAP,CAAYT,KAAZ,EAAmBU,OAAnB,CAA4BC,CAAD,IAAK;MAC5BN,EAAE,CAACM,CAAD,CAAF,GAAQX,KAAK,CAACW,CAAD,CAAb;IACH,CAFD;IAGAN,EAAE,CAACO,gBAAH,CAAoB,MAApB,EAA4B,MAAI;MAC5BX,OAAO,CAACG,OAAR,GAAkBT,aAAa,CAACC,OAAD,CAA/B;MACAO,SAAS,CAACF,OAAO,CAACG,OAAR,GAAkB,MAAlB,GAA2B,OAA5B,CAAT;IACH,CAHD;IAIAC,EAAE,CAACO,gBAAH,CAAoB,OAApB,EAA6B,MAAIT,SAAS,CAAC,OAAD,CAA1C;IAEAE,EAAE,CAACO,gBAAH,CAAoB,OAApB,EAA6B,MAAIT,SAAS,CAAC,OAAD,CAA1C;IAEAG,QAAQ,CAACO,IAAT,CAAcC,WAAd,CAA0BT,EAA1B;IACA,OAAO,MAAI;MACPC,QAAQ,CAACO,IAAT,CAAcE,WAAd,CAA0BV,EAA1B;IACH,CAFD,CAlBU,CAqBd;EACC,CAtBQ,EAsBN,CACCT,OADD,EAECG,GAFD,EAGCG,MAHD,CAtBM,CAAT;EA2BA,MAAMc,QAAQ,GAAG,CACb,KADa,EAEb,MAFa,EAGfC,QAHe,CAGNf,MAHM,IAGI,MAAI;IACrB;EACH,CALgB,GAKb,MAAIC,SAAS,CAAC,KAAD,CALjB;EAOA,OAAO,CACHF,OAAO,CAACG,OADL,EAEHF,MAFG,EAGHc,QAHG,CAAP;AAKH;;AAED,SAASlB,UAAT"},"metadata":{},"sourceType":"module"}